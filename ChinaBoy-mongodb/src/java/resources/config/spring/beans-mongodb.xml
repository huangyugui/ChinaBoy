<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:mongo="http://www.springframework.org/schema/data/mongo"
	xsi:schemaLocation="http://www.springframework.org/schema/context
         http://www.springframework.org/schema/context/spring-context-4.2.xsd
         http://www.springframework.org/schema/beans
	     http://www.springframework.org/schema/beans/spring-beans-4.2.xsd
	     http://www.springframework.org/schema/data/mongo
	     http://www.springframework.org/schema/data/mongo/spring-mongo-1.8.xsd">
	
	<!-- 集群配置replica-set='192.168.110.110:27017,192.168.110.111:27017' -->
	<mongo:mongo id="mongo" host="${mongodb.host}" port="${mongodb.port}" > 
		<!-- 
			connections-per-host连接池大小 ,超出大小则阻塞
		-->
		<mongo:options 
			connections-per-host="10" 
            threads-allowed-to-block-for-connection-multiplier="4"
            connect-timeout="1000" 
            max-wait-time="1500" 
            auto-connect-retry="true"
			max-auto-connect-retry-time="30000"
            socket-keep-alive="true" 
            socket-timeout="1500" 
            slave-ok="true"
            write-number="1" 
            write-timeout="0" 
            write-fsync="true" />
    </mongo:mongo>
            
	<!-- 通过工厂Bean创建mongo连接实例,没有密码就把username和password属性删除了-->
    <mongo:db-factory id="mongoDbFactory" dbname="${mongodb.database}" 
    	username="${mongodb.username}" password="${mongodb.password}" mongo-ref="mongo"/>
    	
	<!-- mongo模板 -->
    <bean id="mongoTemplate" class="org.springframework.data.mongodb.core.MongoTemplate">
        <constructor-arg name="mongoDbFactory" ref="mongoDbFactory"/>
    </bean>
	
</beans>